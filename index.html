<!DOCTYPE html>
<html>
<head>
    <title>Demo </title>
</head>

<body>
    <script src="node_modules/d3/d3.js" charset="utf-8"></script>
    <script>
        var module = {}
    </script>
    <script src="easy-barchart.js"></script>
    <script>

        var parsedData
        d3.json('sample_data.json', function(data){
            histData = d3.layout.histogram()(data.values[5])
            var parsedData = {'points': histData }
            var settings = {
                'x':{
                    'margin':60,
                    'gutter':60,
                    'axisWidth':600,
                    'paddingPercentage':.05,
                },
                'y':{
                    'margin':20,
                    'gutter':30,
                    'axisWidth':600,
                },
                'styles':{
                    'brush': {
                    'color': '#903b20'
                    },
                    'bars':{
                    'color': 'blue'
                    }
                }
            }

            var selection = d3.select('body').append('svg')
                .attr('width', settings.x.margin + 
                    settings.x.gutter +
                    settings.x['axisWidth'])
                .attr('height', settings.y.margin + 
                    settings.y.gutter +
                    settings.y['axisWidth'])

            var plot = module.exports(d3)

            plot.selection(selection)
            .settings(settings)

            plot()

            var events = plot.dispatch()
            events.draw({
                data: parsedData,
                labels: parsedData.points.map(function(p){ return p.x }),
                y: { min: 0 , max: 50 } 
            })

            setTimeout(function(){

                parsedData.points = parsedData.points.map(function(d){
                    d.y = d.y + 10 * Math.random()
                    return d
                })
                events.draw({
                    data: parsedData,
                    labels: parsedData.points.map(function(p){ return p.x }),
                    y: { 
                        min: 0 , 
                        max: d3.max(parsedData.points, function(d){
                            return d.y
                        }) 
                    } 
                })

            }, 4000)
        })


    </script>
</body>
</html>
